

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Train a robot - unsupervised vision &mdash; mygym 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/mygym_theme.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.png"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Train in parallel" href="parallel_training.html" />
    <link rel="prev" title="Train robot - supervised vision" href="train_camera.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> mygym
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">How to</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualize workspace</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_training.html">Train a robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_parametric.html">Set parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_config.html">Edit config file</a></li>
<li class="toctree-l1"><a class="reference internal" href="train_camera.html">Train robot - supervised vision</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Train a robot - unsupervised vision</a></li>
<li class="toctree-l1"><a class="reference internal" href="parallel_training.html">Train in parallel</a></li>
<li class="toctree-l1"><a class="reference internal" href="tensorboard.html">Evaluate with tensorboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_model.html">Test trained model</a></li>
</ul>
<p class="caption"><span class="caption-text">How to - advanced</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="write_reward.html">Create custom reward</a></li>
<li class="toctree-l1"><a class="reference internal" href="create_workspace.html">Create custom workspace</a></li>
<li class="toctree-l1"><a class="reference internal" href="create_network.html">Create custom network</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset.html">Generate dataset</a></li>
</ul>
<p class="caption"><span class="caption-text">Gym</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../environments/workspace.html">Workspaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../environments/mygym_objects.html">Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../environments/mygym_robots.html">Robots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../environments/gym_env.html">GymEnv</a></li>
</ul>
<p class="caption"><span class="caption-text">Baselines</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../baselines/table.html">Baseline networks</a></li>
</ul>
<p class="caption"><span class="caption-text">Important classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../core_modules/base_env.html">BaseEnv</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core_modules/robot.html">Robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core_modules/task.html">Task</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core_modules/reward.html">Reward</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core_modules/vision.html">Vision</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other/camera.html">Camera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other/env_object.html">Object</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">mygym</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Train a robot - unsupervised vision</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/user_guide/train_vae.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="train-a-robot-unsupervised-vision">
<span id="train-vae"></span><h1>Train a robot - unsupervised vision<a class="headerlink" href="#train-a-robot-unsupervised-vision" title="Permalink to this headline">¶</a></h1>
<p>Besides training based on ground truth object positions, MyGym also enables training from image input only. This can be done either in a “supervised” way with YOLACT, or without supervision using a variational autoencoder (VAE).</p>
<p>Here we show you how to train with VAE. For this, we will use one of the five cameras that are available in the environment and a VAE that was pretrained on images from this specific viewpoint.
We then use VAE to generate goal scenes (images of a scene that we want) and to encode the current scene into a latent representation. During training, the objective is to minimise the (euclidean) distance between
the latent vectors of the actual and the goal scenes.</p>
<p>To train a robot using VAE, set in the config file:</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;reward_type&quot;:</span> <span class="pre">&quot;2dvu&quot;,</span></code></p>
<p>Setting up the reward type as “2dvu” means that it will automatically use the VAE to encode the images. Therefore, you also need to specify the path to the VAE model:</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;vae_path&quot;:&quot;/vae/trained_models/vae_armtop_4/model_best.pth.tar&quot;,</span></code></p>
<p>This is of course dependent on the task that you choose and also on the camera that you select (the VAE cannot generalise across different viewpoints).
We currently only support top view of the scene, corresponding to camera 4 (for other viewpoints, you need to train your own VAE -  <a class="reference internal" href="../core_modules/vision.html#vision"><span class="std std-ref">Vision</span></a>):</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;camera&quot;:</span> <span class="pre">4,</span></code></p>
<p>To download the pretrained VAE model, please run:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">mygym</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">sh</span> <span class="pre">./vae/download_weights.sh</span></code></p>
</div></blockquote>
<p>We also recommed to turn the visgym parameter off:</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;visgym&quot;:</span> <span class="pre">0&quot;,</span></code></p>
<p>and the actual and decoded (as seen by the VAE) images can be visualized using the parameter “visualize”:</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;visualize&quot;:1,</span></code></p>
<p>Start the training with this modified config file:</p>
<p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">train.py</span> <span class="pre">--config</span> <span class="pre">my_config.json</span></code></p>
<p>Alternatively, you can specify the above parameters in the command line:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">train</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">reward_type</span><span class="o">=</span><span class="mi">2</span><span class="n">dvu</span><span class="p">,</span>
<span class="o">--</span><span class="n">vae_path</span><span class="o">=/</span><span class="n">vae</span><span class="o">/</span><span class="n">trained_models</span><span class="o">/</span><span class="n">vae_armtop_4</span><span class="o">/</span><span class="n">model_best</span><span class="o">.</span><span class="n">pth</span><span class="o">.</span><span class="n">tar</span>
<span class="o">--</span><span class="n">visgym</span><span class="o">=</span><span class="mi">0</span> <span class="o">--</span><span class="n">visualize</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<p>After the training finishes, find your model in the logdir.</p>
<p>We have also implemented a specific version for the reach task and VAE, designed for the KUKA arm. The goal is to get the KUKA arm in a specific position, based on a goal image. There are no objects included in this task, only the arm moving. To try this scenario, run:</p>
<p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">train.py</span> <span class="pre">--config</span> <span class="pre">configs/train_vae_reach.json</span></code></p>
<p>To learn more about myGym’s vision models, see <a class="reference internal" href="../core_modules/vision.html#vision"><span class="std std-ref">Vision</span></a>.</p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="parallel_training.html" class="btn btn-neutral float-right" title="Train in parallel" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="train_camera.html" class="btn btn-neutral float-left" title="Train robot - supervised vision" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Nikita Sokovnin.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>