

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Create custom network &mdash; mygym 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/mygym_theme.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.png"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Generate dataset" href="dataset.html" />
    <link rel="prev" title="Create custom workspace" href="create_workspace.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> mygym
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">How to</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualize workspace</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_training.html">Train a robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_parametric.html">Set parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_config.html">Edit config file</a></li>
<li class="toctree-l1"><a class="reference internal" href="train_camera.html">Train robot - supervised vision</a></li>
<li class="toctree-l1"><a class="reference internal" href="train_vae.html">Train a robot - unsupervised vision</a></li>
<li class="toctree-l1"><a class="reference internal" href="parallel_training.html">Train in parallel</a></li>
<li class="toctree-l1"><a class="reference internal" href="tensorboard.html">Evaluate with tensorboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_model.html">Test trained model</a></li>
</ul>
<p class="caption"><span class="caption-text">How to - advanced</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="write_reward.html">Create custom reward</a></li>
<li class="toctree-l1"><a class="reference internal" href="create_workspace.html">Create custom workspace</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Create custom network</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset.html">Generate dataset</a></li>
</ul>
<p class="caption"><span class="caption-text">Gym</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../environments/workspace.html">Workspaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../environments/mygym_objects.html">Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../environments/mygym_robots.html">Robots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../environments/gym_env.html">GymEnv</a></li>
</ul>
<p class="caption"><span class="caption-text">Baselines</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../baselines/table.html">Baseline networks</a></li>
</ul>
<p class="caption"><span class="caption-text">Important classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../core_modules/base_env.html">BaseEnv</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core_modules/robot.html">Robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core_modules/task.html">Task</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core_modules/reward.html">Reward</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core_modules/vision.html">Vision</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other/camera.html">Camera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other/env_object.html">Object</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">mygym</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Create custom network</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/user_guide/create_network.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="create-custom-network">
<span id="create-network"></span><h1>Create custom network<a class="headerlink" href="#create-custom-network" title="Permalink to this headline">Â¶</a></h1>
<p>MyGym toolkit is available in such form, that enables you to start with
your own training very easily and quickly. You can select one of the
Reinforcement learning algorithms implemented by Stable baselines <a class="footnote-reference brackets" href="#id2" id="id1">1</a>
or try to design your own.
This tutorial shows how to train a custom network in myGym with your own
implementation of a learning algortihm. We recommend you to get familiar
with the structure of <a class="reference external" href="https://github.com/hill-a/stable-baselines">Stable baselines</a> implementations first.</p>
<p>To create your custom algorithm we recommend you to define it as a
child of an existing Stable baselines <a class="reference external" href="https://stable-baselines.readthedocs.io/en/master/modules/base.html">algorithm</a> class.
To create your custom policy class, follow these <a class="reference external" href="https://stable-baselines.readthedocs.io/en/master/guide/custom_policy.html">instructions</a>.</p>
<p>Choose a keyword for your custom algorithm and add new value to the
dictionary of implemented combinations in <a class="reference external" href="https://github.com/incognite-lab/myGym/blob/master/myGym/train.py">train.py</a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">implemented_combos</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;myalgo&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">*</span><span class="n">framework</span><span class="o">*</span><span class="p">:</span> <span class="p">[</span><span class="n">MyAlgoClass</span><span class="p">,</span> <span class="p">(</span><span class="n">MyPolicyClass</span><span class="p">,</span> <span class="n">env</span><span class="p">),</span> <span class="p">{</span><span class="o">*</span><span class="n">training</span> <span class="n">kwargs</span><span class="o">*</span><span class="p">}]},</span>
                        <span class="o">...</span><span class="p">}</span>
</pre></div>
</div>
<p>To start training with your custom network, set your new algorithm
keyword as the <em>algo</em> parameter in the config file:</p>
<p><code class="docutils literal notranslate"><span class="pre">&quot;algo&quot;:&quot;myalgo&quot;,</span></code></p>
<p>or in the command line:</p>
<p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">train.py</span> <span class="pre">--algo=myalgo</span></code></p>
<p>The function <em>train</em> in the train.py script will read the value from
the implemented_combos dictionary:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model_args</span> <span class="o">=</span> <span class="n">implemented_combos</span><span class="p">[</span><span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;algo&quot;</span><span class="p">]][</span><span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;train_framework&quot;</span><span class="p">]][</span><span class="mi">1</span><span class="p">]</span>
<span class="n">model_kwargs</span> <span class="o">=</span> <span class="n">implemented_combos</span><span class="p">[</span><span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;algo&quot;</span><span class="p">]][</span><span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;train_framework&quot;</span><span class="p">]][</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p>create a model, an instance of MyAlgoClass:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">implemented_combos</span><span class="p">[</span><span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;algo&quot;</span><span class="p">]][</span><span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;train_framework&quot;</span><span class="p">]][</span><span class="mi">0</span><span class="p">](</span><span class="o">*</span><span class="n">model_args</span><span class="p">,</span> <span class="o">**</span><span class="n">model_kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>and start with training:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">total_timesteps</span><span class="o">=</span><span class="n">arg_dict</span><span class="p">[</span><span class="s2">&quot;steps&quot;</span><span class="p">],</span> <span class="n">callback</span><span class="o">=</span><span class="n">callbacks_list</span><span class="p">)</span>
</pre></div>
</div>
<p>When finished, trained model is saved to the <em>lodgir</em>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">model_logdir</span><span class="p">,</span> <span class="n">model_name</span><span class="p">))</span>
</pre></div>
</div>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Hill, Ashley and Raffin, Antonin and Ernestus, Maximilian and Gleave, Adam and Kanervisto, Anssi and Traore, Rene and Dhariwal, Prafulla and Hesse, Christopher and Klimov, Oleg and Nichol, Alex and Plappert, Matthias and Radford, Alec and Schulman, John and Sidor, Szymon and Wu, Yuhuai (2018). Stable Baselines. Github repository.</p>
</dd>
</dl>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="dataset.html" class="btn btn-neutral float-right" title="Generate dataset" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="create_workspace.html" class="btn btn-neutral float-left" title="Create custom workspace" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Nikita Sokovnin.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>